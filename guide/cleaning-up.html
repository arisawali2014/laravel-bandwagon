<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cleaning up old events | Laravel Bandwagon</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Social proof package for Laravel">
    <meta name="theme-color" content="#4E8FA4">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.d81db80c.css" as="style"><link rel="preload" href="/assets/js/app.ca8f1edf.js" as="script"><link rel="preload" href="/assets/js/2.d56dc8d5.js" as="script"><link rel="preload" href="/assets/js/14.767d31a7.js" as="script"><link rel="preload" href="/assets/js/4.95508267.js" as="script"><link rel="prefetch" href="/assets/js/10.f8caad52.js"><link rel="prefetch" href="/assets/js/11.95fdd5f8.js"><link rel="prefetch" href="/assets/js/12.b4ce65fe.js"><link rel="prefetch" href="/assets/js/13.4fd3a4af.js"><link rel="prefetch" href="/assets/js/15.a52a0e0b.js"><link rel="prefetch" href="/assets/js/16.d7b628db.js"><link rel="prefetch" href="/assets/js/17.05750a5a.js"><link rel="prefetch" href="/assets/js/18.2049f3dc.js"><link rel="prefetch" href="/assets/js/19.d41a04a7.js"><link rel="prefetch" href="/assets/js/3.45031d4a.js"><link rel="prefetch" href="/assets/js/5.b10bc386.js"><link rel="prefetch" href="/assets/js/6.fe1d9027.js"><link rel="prefetch" href="/assets/js/7.7ba9a49f.js"><link rel="prefetch" href="/assets/js/8.b33bf9e9.js"><link rel="prefetch" href="/assets/js/9.9da60122.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d81db80c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Laravel Bandwagon</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="https://github.com/chasenyc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Author
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/bndwgn/laravel-bandwagon" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Source
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">
  Guide
</a></div><div class="nav-item"><a href="https://github.com/chasenyc" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Author
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/bndwgn/laravel-bandwagon" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Source
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/guide/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/guide/configuration.html" class="sidebar-link">Configuration</a></li><li><a href="/guide/cleaning-up.html" aria-current="page" class="active sidebar-link">Cleaning up old events</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/cleaning-up.html#introduction" class="sidebar-link">Introduction</a></li><li class="sidebar-sub-header"><a href="/guide/cleaning-up.html#console-command" class="sidebar-link">Console command</a></li><li class="sidebar-sub-header"><a href="/guide/cleaning-up.html#scheduling" class="sidebar-link">Scheduling</a></li><li class="sidebar-sub-header"><a href="/guide/cleaning-up.html#configuration" class="sidebar-link">Configuration</a></li></ul></li><li><a href="/guide/firing-events.html" class="sidebar-link">Firing events</a></li><li><a href="/guide/rendering.html" class="sidebar-link">Frontend</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="cleaning-up-old-events"><a href="#cleaning-up-old-events" class="header-anchor">#</a> Cleaning up old events</h1> <p></p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#console-command">Console command</a></li><li><a href="#scheduling">Scheduling</a></li><li><a href="#configuration">Configuration</a></li></ul></div><p></p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Every time an event is created using the the <code>Bandwagon::createEvent()</code> command a record is stored in the database in a table called <code>bandwagon_events</code>. Depending on how many events are being fired you will most likely want to cleanup this table from time to time. Additionally the <code>bandwagon.php</code> config key <code>oldest</code> dictates the oldest event to display to users, thus rendering any events older than <code>oldest</code> useless for this packages purposes.</p> <h2 id="console-command"><a href="#console-command" class="header-anchor">#</a> Console command</h2> <p>Out of the box you are provided with the following console command:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>php artisan bandwagon:cleanup
</code></pre></div><h2 id="scheduling"><a href="#scheduling" class="header-anchor">#</a> Scheduling</h2> <p>It is recommended to add the command to run on some interval to ensure your table does not get too large by adding it <code>Kernel.php</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// App/Console/Kernel.php</span>

<span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function">schedule</span><span class="token punctuation">(</span>Schedule <span class="token variable">$schedule</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$schedule</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">command</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bandwagon:cleanup'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">daily</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <p>This command will remove all events older than what is specified in the <code>bandwagon.php</code> config. You can see the specific key here:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">// config/bandwagon.php</span>

<span class="token single-quoted-string string">'cleanup'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'enabled'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'BANDWAGON_CLEANUP_ENABLED'</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token single-quoted-string string">'olderthan'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">env</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'BANDWAGON_CLEANUP_OLDER_THAN'</span><span class="token punctuation">,</span> <span class="token number">86400</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
</code></pre></div><p>This will find any events older than <code>time() - config('bandwagon.cleanup.olderthan')</code>
and delete them from the database to keep a maintainable size to this table. Feel free to adjust it as you would like but keep in mind it is best practice to make this value equal to or higher than the <code>oldest</code> key found in <code>bandwagon.php</code>.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/configuration.html" class="prev">
        Configuration
      </a></span> <span class="next"><a href="/guide/firing-events.html">
        Firing events
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.ca8f1edf.js" defer></script><script src="/assets/js/2.d56dc8d5.js" defer></script><script src="/assets/js/14.767d31a7.js" defer></script><script src="/assets/js/4.95508267.js" defer></script>
  </body>
</html>
